# 🌐 联网搜索功能说明

## ✅ 您的问题解答

### 1. **AI 是否有记忆功能？**

**答案：是的，有会话级别的记忆！**

- ✅ 每次辩论中，所有 AI 都能"看到"完整的对话历史
- ✅ 每个 AI 回复时都会参考之前所有人的发言
- ✅ 这确保了辩论的连贯性和针对性

**记忆范围：**
- 📝 当前会话的所有消息（用户提问 + 所有 AI 回复）
- 🔄 每轮辩论都基于上一轮的内容
- ⚠️ **限制**：关闭页面后记忆会清空（未来可以添加持久化存储）

**技术实现：**
```python
# backend/main.py 第 37 行
chat_history: List[dict] = []  # 存储所有对话历史

# 每次 AI 生成回复时，都会传入完整历史
async for chunk in provider.stream_response(chat_history):
    # AI 可以看到所有之前的对话
```

---

### 2. **AI 是否能联网搜索？**

**答案：现在可以了！** 🎉

我刚刚为您添加了**联网搜索增强功能**：

#### 🆕 新增功能：

1. **联网搜索开关** 🌐
   - 位置：输入框上方，总结者选择器右侧
   - 状态：✓ 已开启（绿色） / ✗ 已关闭（灰色）
   - 可随时切换

2. **搜索流程**
   ```
   用户提问 → 联网搜索 → 获取最新资料 → AI 基于资料辩论
   ```

3. **搜索引擎**
   - 使用 **DuckDuckGo** 搜索引擎
   - 免费、隐私友好
   - 每次搜索返回 5 条最相关结果

4. **AI 增强效果**
   - ✅ 获取实时数据和最新新闻
   - ✅ 引用真实案例和统计数据
   - ✅ 提高回答的准确性和时效性

---

## 🎮 使用指南

### 开启联网搜索：

1. **找到开关**
   - 在输入框上方
   - 标记为 "🌐 联网搜索"

2. **点击开关**
   - 关闭状态：灰色按钮显示 "✗ 已关闭"
   - 开启状态：绿色按钮显示 "✓ 已开启"

3. **输入话题并发送**
   - 例如："2026年人工智能最新发展趋势"

4. **观察效果**
   - 系统会先显示 "🌐 正在搜索互联网相关信息..."
   - 搜索完成后显示 "✓ 已搜索到 5 条相关信息"
   - AI 会基于搜索结果进行更准确的辩论

---

## 📊 功能对比

| 模式 | 信息来源 | 时效性 | 准确度 | 适用场景 |
|------|---------|--------|--------|----------|
| **关闭搜索** | AI 训练数据 | 训练截止日期前 | 一般性知识准确 | 通用话题、理论讨论 |
| **开启搜索** | 实时互联网 | 最新信息 | 实时数据准确 | 时事热点、数据查询 |

---

## 💡 使用建议

### 适合开启搜索的场景：
- ✅ **时事热点**："2026年奥运会筹备情况"
- ✅ **最新科技**："最新 AI 模型性能对比"
- ✅ **数据查询**："中国 GDP 增长趋势"
- ✅ **政策法规**："最新环保政策解读"

### 适合关闭搜索的场景：
- ✅ **哲学讨论**："人工智能是否有意识"
- ✅ **理论分析**："资本主义与社会主义的区别"
- ✅ **文学创作**："科幻小说创意讨论"
- ✅ **通用知识**："如何提高工作效率"

---

## 🔧 技术细节

### 搜索实现：

```python
# backend/web_search.py
class WebSearcher:
    def search(self, query: str, max_results: int = 5):
        """搜索互联网信息"""
        with DDGS() as ddgs:
            for r in ddgs.text(query, max_results=max_results):
                results.append({
                    'title': r.get('title', ''),
                    'snippet': r.get('body', ''),
                    'url': r.get('href', '')
                })
        return results
```

### 集成到辩论流程：

1. 用户发送话题
2. **如果开启搜索**：
   - 执行 DuckDuckGo 搜索
   - 格式化搜索结果
   - 将结果添加到对话历史
3. AI 获取包含搜索结果的历史记录
4. AI 基于搜索结果生成回复

---

## 🎯 测试示例

### 示例 1：时事话题（推荐开启搜索）

**话题**："2026年人工智能十大趋势"

**关闭搜索**：
- AI 基于训练数据预测

**开启搜索**：
- ✅ 找到央视发布的官方报告
- ✅ 引用具体的十大趋势内容
- ✅ 提供权威来源链接

### 示例 2：理论讨论（可不开启搜索）

**话题**："远程办公的优缺点"

**关闭搜索**：
- AI 基于常识和逻辑分析
- 足够应对这类通用话题

**开启搜索**：
- ✅ 获取最新远程办公统计数据
- ✅ 找到最新研究报告
- ✅ 引用真实公司案例

---

## 🚀 未来增强计划

1. **多搜索源支持**
   - Google Custom Search
   - Bing Search API
   - 学术搜索（Google Scholar）

2. **智能搜索**
   - 自动提取关键词
   - 多轮搜索优化
   - 结果去重和排序

3. **搜索结果展示**
   - 在界面显示搜索来源
   - 可点击查看原文
   - 引用标注

4. **搜索历史**
   - 保存搜索记录
   - 复用搜索结果
   - 节省API调用

---

## ❓ 常见问题

**Q1: 搜索会增加等待时间吗？**
- A: 会增加 2-5 秒，但能显著提高回答质量

**Q2: 搜索结果是否准确？**
- A: 使用 DuckDuckGo，质量可靠，但建议关键话题自己验证

**Q3: 搜索是否会暴露隐私？**
- A: 使用 DuckDuckGo 不追踪用户，隐私友好

**Q4: 能否自定义搜索数量？**
- A: 目前固定 5 条，未来可以添加配置选项

**Q5: 搜索失败怎么办？**
- A: 系统会显示警告，AI 会基于训练数据继续辩论

---

## 🎉 总结

现在您的 AI 辩论平台具备：

1. ✅ **会话记忆** - AI 记得之前说过的话
2. ✅ **联网搜索** - 获取最新互联网资料
3. ✅ **多轮辩论** - 1-5 轮可选
4. ✅ **智能总结** - 可选总结者
5. ✅ **流式输出** - 实时打字效果

享受您的增强版 AI 辩论平台吧！🎊
